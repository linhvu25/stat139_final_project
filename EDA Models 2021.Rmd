---
title: "Stat139_Final_Project"
author: "Brice Laurent, Linh Vu, Aissata Bah"
date: "2023-11-30"
output: pdf_document
---

```{r corr}
data_clean <- read.csv("data/data_clean.csv")
data_clean_2021 = data_clean[data_clean$year == 2021,]
df = data_clean_2021[2:278,]

# which(colnames(df) == "x1.1")
# which(colnames(df) == "x1.6")
cor(data_clean_2021[,41:46], use="na.or.complete")

# which(colnames(df) == "x2.1")
# which(colnames(df) == "x2.4")
cor(data_clean_2021[,48:51], use="na.or.complete")

# which(colnames(df) == "x3.1")
# which(colnames(df) == "x3.4")
cor(data_clean_2021[,53:56], use="na.or.complete")

# which(colnames(df) == "x4.1")
# which(colnames(df) == "x4.8")
cor(data_clean_2021[,58:65], use="na.or.complete")

# which(colnames(df) == "x5.1")
# which(colnames(df) == "x5.3")
cor(data_clean_2021[,67:69], use="na.or.complete")

# which(colnames(df) == "x6.1")
# which(colnames(df) == "x6.5")
cor(data_clean_2021[,71:75], use="na.or.complete")

# less correlation
# which(colnames(df) == "x7.1")
# which(colnames(df) == "x7.7")
cor(data_clean_2021[,77:83], use="na.or.complete")

# which(colnames(df) == "x8.1")
# which(colnames(df) == "x8.6")
cor(data_clean_2021[,85:90], use="na.or.complete")
```


```{r}
data_clean_2021 = data_clean[data_clean$year == 2021,]

#baseline using overall ROL as predictors
model0 = lm(hdi ~ wjp.rule + region, data = df)
plot(model0)

#using the individual categorical averages as predictors
model1 = lm(hdi~factor.1 +factor.2 +factor.3 +factor.4 +factor.5 +factor.6 +factor.7 + factor.8 + region, data = df)
plot(model1)

#random intercept and slope model
library(lme4)
model2 = lmer(hdi ~ wjp.rule + (1 + wjp.rule || region), data = df)

model3 = lmer(hdi~factor.1 +factor.2 +factor.3 +factor.4+factor.5 +factor.6 +factor.7 + factor.8 + (1 + factor.1 +factor.2 +factor.3 +factor.4+factor.5 +factor.6 +factor.7 + factor.8 || region), data = df)

AIC(model0, model1, model2, model3)
```

